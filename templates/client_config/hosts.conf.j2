object Endpoint "{{ hostvars[item].inventory_hostname }}" {
        host = "{{ hostvars[item].ansible_host }}"
}

object Zone "{{ hostvars[item].inventory_hostname }}" {
        endpoints = [ "{{ hostvars[item].inventory_hostname }}" ]
        parent = "{{ icinga2_zone_master_endpoint_name }}"
}

object Host "{{ hostvars[item].inventory_hostname }}" {
  import "generic-host"
  name = "{{ hostvars[item].inventory_hostname }}"
  vars.agent_endpoint = name
  {% if hostvars[item].icinga2_client_vars is defined %}
    address = "{{ hostvars[item].ansible_host }}"
    vars.os = "{{ hostvars[item].ansible_system }}"
    vars.os_family = "{{ hostvars[item].ansible_distribution }}"
    {{ hostvars[item].icinga2_client_vars }}
  {% else %}{{ icinga2_client_vars_defaults }}
    vars.client_endpoint = "{{ hostvars[item].inventory_hostname }}"
  {% endif %}
}
